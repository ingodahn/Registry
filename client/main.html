<head>
  <title>Registry</title>
</head>

<template name="main_page">
<div class="container">
  {{> loginButtons}}
</div>
 <div id="registry" class="container">
    <h2 class="registryHeading">{{_ registry_heading}}</h2>
    <div id="items-container" class="container">
      {{> content}}
    </div>
  </div>
</template>

<template name="header">
 <div id="header" class="container">
  {{#if current_item}}
    <h3>{{_ currentItemType}}: {{get_item_field current_item 'Title'}}</h3>
  {{else}}
    {{#if new_item}}
      <h3>{{_ "Add New Item"}}</h3>
    {{/if}}
  {{/if}}
 </div>
</template>

<template name="mode">
<div id="mode-container" class="container">
  {{#if logged_in}}
    <div class="btn btn-primary" id="btnAdd">{{_ "Add"}}</div>
  {{/if}}
  Filter:
  <input type="text" id="search_term" value=""/>
  <div class="btn btn-primary" id="btnAll">{{_ "All"}}</div>
</div>
</template>

<template name="content">
  {{> header}}
  {{#if new_item}}
    {{> add_item}}
  {{else}}
    {{#if current_item}}
      {{> item_details}}
    {{else}}
      {{> item_list}}
    {{/if}}
  {{/if}}
</template>

<template name="add_item">
  <div class="item form-group" id="newItem">
    <div>
        <label>{{_ 'Title'}}:
          <input type="text" size="60" id="add-title" class="form-control" value="" />
        </label>
    </div><div>
        <label>{{_ 'Description'}}:
          <textarea rows="5" cols="60" id="add-description" class="form-control" value="" ></textarea>
        </label>
    </div><div>
        <label>
        URL: 
          <input type="url" size="60" id="add-url" class="form-control" value="https://" />
        </label>
    </div><div>
        <label>Status: 
          <select id="add-status" class="form-control">
            <option selected value='public'>{{_ 'Public'}}</option>
            <option value='private'>{{_ 'Private'}}</option>
            <option value='deprecated'>{{_ 'Deprecated'}}</option>
          </select>
        </label>
    </div>
      <div>
          {{> add_item_specific}}
      </div>
    <div>
      <div class="script btn btn-primary" id="btnSaveNewItem">Speichern</div>
      <div class="script btn btn-primary" id="btnCancelNewItem">Abbruch</div>
    </div>
  </div>
</template>

<template name="item_details">
{{#if can_modify}}
  <div class="item form-group" id="changeItem">
        <div><label>{{_ 'Title'}}: <input type="text" size="60" id="item-title" class="form-control" value="{{current_title}}" /></label></div>
        <div><label>{{_ 'Description'}}: <textarea rows="5" cols="60" id="item-description" class="form-control" value="{{current_description}}" ></textarea></label></div>
        <div><label>URL: <input type="url" size="60" id="item-url" class="form-control" value="{{current_url}}" /></label></div>
        {{#if is_admin}}
          <div><label>{{_ 'Owner'}}:
            <select id="owner" class="form-control">
              {{#each users}}
                <option {{selected_user}} value="{{this._id}}">{{this.username}}</option>
              {{/each}}
            </select>
          </label></div> 
        {{else}}
            <p><b>{{_ 'Owner'}}:</b> {{current_owner}}</p>
        {{/if}}
        <div>
        <label>Status: 
          <select id="status" class="form-control">
            <option {{selected_status 'public'}} value='public'>{{_ 'Public'}}</option>
            <option {{selected_status 'private'}} value='private'>{{_ 'Private'}}</option>
            <option {{selected_status 'deprecated'}} value='deprecated'>{{_ 'Deprecated'}}</option>
          </select>
        </label>
            <div><dt>{{_ 'Last Modified'}}:</dt><dd>{{last_modified}}</dd></div></div>
  </div>
    <div>
        {{> item_details_specific}}
    </div>
    <div>
    <div class="script btn btn-primary" id="btnSaveChangeItem">Speichern</div>
      <div class="script btn btn-primary" id="btnCancelChangeItem">Abbruch</div>
      <button type="button" class="close delete_item">L&ouml;schen</button>
    </div>
{{else}}
  <div class="item_details">
    <dl>
      <dt>{{_ 'Description'}}:</dt><dd class="description"><pre>{{current_description}}</pre></dd>
      <dt>URL:</dt><dd><a href="{{current_url}}" target="_blank">{{current_url}}</a></dd>
      <dt>Status:</dt><dd>{{_ current_status}}</dd>
      <dt>{{_ 'Owner'}}:</dt><dd>{{current_owner}}</dd>
        <dt>{{_ 'Last Modified'}}:</dt><dd>{{last_modified}}</dd>
        {{> item_details_specific_print}}
      <div class="script btn btn-primary" id="btnCancelChangeItem">Zur&uuml;ck</div>
   </dl>
  </div>
{{/if}}
</template>

<template name="item_list">
   <div>
      {{> mode}}
    <table>
    <thead>
      <tr>
        <th>{{_ "Title"}}</th>
        <th>{{_ "Description"}}</th>
          {{> list_heading_specific}}
        <th>{{_ "Owner"}}</th>
        <th>{{_ "Actions"}}</th>
      </tr>
    </thead>
    <tbody>
    {{#each items}}
      <tr class="{{item_status}}">
        <td><a href="{{URL}}" target="_blank">{{Title}}</a></td>
        <td width="70%"><pre>{{Description}}</pre></td>
          {{> list_item_specific}}
        <td>{{_ doc_owner}}</td>
        <td>
          <div id="item_list" class="btn-group">
            <button type="button" class="btn btn-primary edit_item">Details</button>
          </div>
        </td>
      </tr>
    {{/each}}
    </tbody>
    </table>
    <div>
      <span class="public">{{_ "Public"}}</span>
      <span class="private">{{_ "Private"}}</span>
      <span class="deprecated">{{_ "Deprecated"}}</span>
    </div>
  </div>
</template>

<template name="add_item_specific">
    {{> get_specific_fields}}
</template>

<template name="item_details_specific">
    {{> get_specific_fields}}
</template>

<template name="item_details_specific_print">
    {{> get_specific_fields}}
</template>

<template name="empty">

</template>

<template name="route_root">
    {{> yield}}
</template>

<template name="RegSelect">
    <h2>{{_ "Please Select Item Type"}}</h2>
    <ul>
        <li><a href="./scripts">{{_ "Math Scripts"}}</a></li>
        <li><a href="/sagecell">{{_ "SageCell Worksheets"}}</a></li>
        <li><a href="./mathcoach">{{_ "MathCoach Questions"}}</a></li>
    </ul>
</template>

